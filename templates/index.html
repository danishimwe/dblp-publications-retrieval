<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DBLP  Authors Publications</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://danishimwe.github.io/">

    <!-- Fonts and Styles -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Icons&family=Source+Sans+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&display=swap" rel="stylesheet">
    <link href="https://stijl.kuleuven.be/releases/ttt/css/wms.css" rel="stylesheet">
    <link href="https://www.esat.kuleuven.be/++plone++kuleuven.staff/staff.css" rel="stylesheet">
    <link href="https://www.esat.kuleuven.be/++theme++ku-leuven-theme/styles/theme.min.css" rel="stylesheet">

    <!-- Google Tag Manager -->
    <script async src="//www.googletagmanager.com/gtm.js?id=GTM-TMP459"></script>

    <!-- Custom CSS for Sticky Footer -->
    <style>
        /* Ensure the HTML and Body elements take up the full height of the viewport */
        html, body {
            height: 100%;
            margin: 0;
            display: flex;
            flex-direction: column;
        }

        /* Flex container for content and footer */
        .content {
            flex: 1;
        }

        /* Footer should be at the bottom */
        .global-footer {
            background-color: #f8f9fa;
            padding: 20px 0;
        }

        .global-footer {
    background-color: #f8f9fa; /* Light background color */
    padding: 10px 0; /* Add some vertical padding */
    border-top: 1px solid #ddd; /* Optional: a border at the top of the footer */
    font-size: 14px;
}

.global-footer .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.global-footer .logo-img {
    margin-right: 20px;
}

.global-footer ul {
    display: flex;
    list-style: none;
    padding-left: 0;
    margin-bottom: 0;
}

.global-footer ul li {
    margin-left: 20px;
}

.global-footer ul li a {
    text-decoration: none;
    color: #0072c6; /* Global footer blue color */
}

.global-footer ul li a:hover {
    text-decoration: underline;
}

.global-footer .share img {
    width: 30px;
    height: 30px;
    margin-left: 15px;
}

.global-footer .share span {
    margin-right: 10px;
    color: #333;
}

.global-footer a {
    color: #0072c6; /* Global footer blue color */
    text-decoration: none;
}

.global-footer a:hover {
    text-decoration: underline;
}

@keyframes ldio-yzaezf3dcmj {
  0% { opacity: 1 }
  100% { opacity: 0 }
}
.ldio-yzaezf3dcmj div {
  left: 94px;
  top: 48px;
  position: absolute;
  animation: ldio-yzaezf3dcmj linear 1s infinite;
  background: #fe718d;
  width: 12px;
  height: 24px;
  border-radius: 6px / 12px;
  transform-origin: 6px 52px;
}.ldio-yzaezf3dcmj div:nth-child(1) {
  transform: rotate(0deg);
  animation-delay: -0.9166666666666666s;
  background: #fe718d;
}.ldio-yzaezf3dcmj div:nth-child(2) {
  transform: rotate(30deg);
  animation-delay: -0.8333333333333334s;
  background: #fe718d;
}.ldio-yzaezf3dcmj div:nth-child(3) {
  transform: rotate(60deg);
  animation-delay: -0.75s;
  background: #fe718d;
}.ldio-yzaezf3dcmj div:nth-child(4) {
  transform: rotate(90deg);
  animation-delay: -0.6666666666666666s;
  background: #fe718d;
}.ldio-yzaezf3dcmj div:nth-child(5) {
  transform: rotate(120deg);
  animation-delay: -0.5833333333333334s;
  background: #fe718d;
}.ldio-yzaezf3dcmj div:nth-child(6) {
  transform: rotate(150deg);
  animation-delay: -0.5s;
  background: #fe718d;
}.ldio-yzaezf3dcmj div:nth-child(7) {
  transform: rotate(180deg);
  animation-delay: -0.4166666666666667s;
  background: #fe718d;
}.ldio-yzaezf3dcmj div:nth-child(8) {
  transform: rotate(210deg);
  animation-delay: -0.3333333333333333s;
  background: #fe718d;
}.ldio-yzaezf3dcmj div:nth-child(9) {
  transform: rotate(240deg);
  animation-delay: -0.25s;
  background: #fe718d;
}.ldio-yzaezf3dcmj div:nth-child(10) {
  transform: rotate(270deg);
  animation-delay: -0.16666666666666666s;
  background: #fe718d;
}.ldio-yzaezf3dcmj div:nth-child(11) {
  transform: rotate(300deg);
  animation-delay: -0.08333333333333333s;
  background: #fe718d;
}.ldio-yzaezf3dcmj div:nth-child(12) {
  transform: rotate(330deg);
  animation-delay: 0s;
  background: #fe718d;
}
.loadingio-spinner-spinner-2by998twmg8 {
  width: 200px;
  height: 200px;
  display: inline-block;
  overflow: hidden;
  background: #ffffff;
}
.ldio-yzaezf3dcmj {
  width: 100%;
  height: 100%;
  position: relative;
  transform: translateZ(0) scale(1);
  backface-visibility: hidden;
  transform-origin: 0 0; /* see note above */
}
.ldio-yzaezf3dcmj div { box-sizing: content-box; }
/* [ldio] generated by https://loading.io */

    </style>
</head>

<body>
    <div class="content">
        <div class="container mt-5">
            <div class="row">
                <div class="col-md-6 offset-md-3">
                    <div class="card">
                        <div class="card-header text-center">
                            <h4>Retrieve DBLP Publications</h4>
                        </div>
                        <div class="card-body">
                            <form id="uploadForm" enctype="multipart/form-data">
                                <div class="mb-3">
                                    <label for="file" class="form-label">Select Excel File</label>
                                    <input class="form-control" type="file" name="file" accept=".xls,.xlsx,.xlsm,.csv" required>
                                </div>
                                <div class="text-center">
                                    <button type="submit" class="btn btn-primary">Retrieve Publications</button>
                                    <a id="downloadButton" href="#" class="btn btn-success" style="display:none;" download>Download File</a>
                                </div>
                                <div id="loading" style="display:none; text-align:center;">
                                    <div class="loadingio-spinner-spinner-2by998twmg8"><div class="ldio-yzaezf3dcmj">
                                        <div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div>
                                        </div></div>
                                    <p>Retrieving publications, please wait...</p>
                                </div>
                                <div id="publicationCount" style="display:none; text-align:center; margin-top: 10px;">
                                    <p id="countText"></p>
                                </div>
                                <div id="remainingAuthors" style="display:none; text-align:center; margin-top: 10px; color: red;"></div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="global-footer noindex hidden-print">
        <div class="container d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center">
                <ul class="list-unstyled d-flex ms-4">Developed by  <a href="https://danishimwe.github.io/" target="_blank"> Daniel Ishimwe</a></ul>
                    <li class="ms-3">Copyright reserved</a></li>
                </ul>
            </div>
            <div class="d-flex align-items-center">
                <span>Follow Daniel Ishimwe via</span>
                <a href="https://www.facebook.com/daniel.ishimwe.k" target="_blank">
                    <svg role="img" width="30" height="30" viewBox="0 0 1792 1792">
                        <title>Facebook</title>
                        <path d="M1376 128q119 0 203.5 84.5T1664 416v960q0 119-84.5 203.5T1376 1664h-188v-595h199l30-232h-229V689q0-56 23.5-84t91.5-28l122-1V369q-63-9-178-9-136 0-217.5 80T948 666v171H748v232h200v595H416q-119 0-203.5-84.5T128 1376V416q0-119 84.5-203.5T416 128h960z"></path>
                    </svg>
                </a>
                <a href="https://twitter.com/daniel_ishimw_k" target="_blank">
                    <svg role="img" width="30" height="30" viewBox="0 0 1792 1792">
                        <title>Twitter</title>
                        <path d="M1408 610q-56 25-121 34 68-40 93-117-65 38-134 51-61-66-153-66-87 0-148.5 61.5T883 722q0 29 5 48-129-7-242-65T454 550q-29 50-29 106 0 114 91 175-47-1-100-26v2q0 75 50 133.5t123 72.5q-29 8-51 8-13 0-39-4 21 63 74.5 104t121.5 42q-116 90-261 90-26 0-50-3 148 94 322 94 112 0 210-35.5t168-95 120.5-137 75-162T1304 746q0-18-1-27 63-45 105-109zm256-194v960q0 119-84.5 203.5T1376 1664H416q-119 0-203.5-84.5T128 1376V416q0-119 84.5-203.5T416 128h960q119 0 203.5 84.5T1664 416z"></path>
                    </svg>
                </a>
                <a href="https://www.instagram.com/daniel.ishimwe.k" target="_blank">
                    <svg role="img" width="30" height="30" viewBox="0 0 1792 1792">
                        <title>Instagram</title>
                        <path d="M1490 1426V778h-135q20 63 20 131 0 126-64 232.5T1137 1310t-240 62q-197 0-337-135.5T420 909q0-68 20-131H299v648q0 26 17.5 43.5T360 1487h1069q25 0 43-17.5t18-43.5zm-284-533q0-124-90.5-211.5T897 594q-127 0-217.5 87.5T589 893t90.5 211.5T897 1192q128 0 218.5-87.5T1206 893zm284-360V368q0-28-20-48.5t-49-20.5h-174q-29 0-49 20.5t-20 48.5v165q0 29 20 49t49 20h174q29 0 49-20t20-49zm174-208v1142q0 81-58 139t-139 58H325q-81 0-139-58t-58-139V325q0-81 58-139t139-58h1142q81 0 139 58t58 139z"></path>
                    </svg>
                </a>
                <a href="https://www.linkedin.com/in/daniel-ishimwe-k/" target="_blank">
                    <svg role="img" width="30" height="30" viewBox="0 0 1792 1792">
                        <title>LinkedIn</title>
                        <path d="M365 1414h231V720H365v694zm246-908q-1-52-36-86t-93-34-94.5 34-36.5 86q0 51 35.5 85.5T479 626h1q59 0 95-34.5t36-85.5zm585 908h231v-398q0-154-73-233t-193-79q-136 0-209 117h2V720H723q3 66 0 694h231v-388q0-38 7-56 15-35 45-59.5t74-24.5q116 0 116 157v371zm468-998v960q0 119-84.5 203.5T1376 1664H416q-119 0-203.5-84.5T128 1376V416q0-119 84.5-203.5T416 128h960q119 0 203.5 84.5T1664 416z"></path>
                    </svg>
                </a>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('uploadForm').onsubmit = async function(event) {
            event.preventDefault();

            const formData = new FormData(this);
            const loadingElement = document.getElementById('loading');
            const downloadButton = document.getElementById('downloadButton');
            const publicationCountElement = document.getElementById('publicationCount');
            const countTextElement = document.getElementById('countText');
            const remainingAuthorsElement = document.getElementById('remainingAuthors');

            // Show the loading spinner
            loadingElement.style.display = 'block';
            downloadButton.style.display = 'none';
            publicationCountElement.style.display = 'none';
            remainingAuthorsElement.style.display = 'none';  // Hide initially

            try {
                const response = await fetch('/upload', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.publication_count > 0) {
                        downloadButton.href = `/download/${data.filename}`;
                        downloadButton.style.display = 'inline-block'; // Show the download button
                    }

                    // Display the number of publications retrieved
                    countTextElement.textContent = `Number of publications retrieved: ${data.publication_count}`;
                    publicationCountElement.style.display = 'block';

                    // Check if there are failed authors
                    if (data.failed_authors && data.failed_authors.length > 0) {
                        remainingAuthorsElement.innerHTML = `The dblp server went down before we could complete the following authors: ${data.failed_authors.join(', ')}`;
                        remainingAuthorsElement.style.display = 'block';  // Show the message
                    }
                } else {
                    alert('An error occurred while processing the file.');
                }
            } catch (error) {
                alert('There was an error with the request: ' + error.message);
            } finally {
                // Hide the loading spinner
                loadingElement.style.display = 'none';
            }
        };

    </script>    
</body>

</html>